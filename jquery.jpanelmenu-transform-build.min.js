(function(c){c.jPanelMenu=function(g){if("undefined"==typeof g||null==g)g={};var a={options:c.extend({menu:"#menu",trigger:".menu-trigger",excludedPanelContent:"style, script",alwaysShowFirstMenu:!1,direction:"left",openPosition:"250px",animated:!0,closeOnContentClick:!0,keyboardShortcuts:[{code:27,open:!1,close:!0},{code:37,open:!1,close:!0},{code:39,open:!0,close:!0},{code:77,open:!0,close:!0}],duration:150,openDuration:g.duration||150,closeDuration:g.duration||150,easing:"ease-in-out",openEasing:g.easing||
"ease-in-out",closeEasing:g.easing||"ease-in-out",before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},g),settings:{transitionsSupported:"WebkitTransition"in document.body.style||"MozTransition"in document.body.style||"msTransition"in document.body.style||"OTransition"in document.body.style||"Transition"in document.body.style,transformsSupported:"WebkitTransform"in
document.body.style||"MozTransform"in document.body.style||"msTransform"in document.body.style||"OTransform"in document.body.style||"Transform"in document.body.style,cssPrefix:"",shiftFixedChildren:!1,panelPosition:"relative",positionUnits:"px"},menu:"#jPanelMenu-menu",panel:".jPanelMenu-panel",fixedChildren:[],timeouts:{},clearTimeouts:function(){clearTimeout(a.timeouts.open);clearTimeout(a.timeouts.afterOpen);clearTimeout(a.timeouts.afterClose)},setPositionUnits:function(){var b=!1,c=["%","px",
"em"];for(unitID in c){var d=c[unitID];a.options.openPosition.toString().substr(-d.length)==d&&(b=!0,a.settings.positionUnits=d)}b||(a.options.openPosition=parseInt(a.options.openPosition)+a.settings.positionUnits)},computePositionStyle:function(b,c){var d=b?a.options.openPosition:"0"+a.settings.positionUnits,f={};a.settings.transformsSupported?(d="translate3d("+(b&&"right"==a.options.direction?"-":"")+d+",0,0)",c?(f="",""!=a.settings.cssPrefix&&(f=a.settings.cssPrefix+"transform:"+d+";"),f+="transform:"+
d+";"):(""!=a.settings.cssPrefix&&(f[a.settings.cssPrefix+"transform"]=d),f.transform=d)):c?f=a.options.direction+": "+d+";":f[a.options.direction]=d;return f},setCSSPrefix:function(){a.settings.cssPrefix=a.getCSSPrefix()},checkFixedChildren:function(){a.disableTransitions();var b={position:c(a.panel).css("position")};b[a.options.direction]="auto"==c(a.panel).css(a.options.direction)?0:c(a.panel).css(a.options.direction);c(a.panel).find("> *").each(function(){"fixed"==c(this).css("position")&&"auto"==
c(this).css(a.options.direction)&&a.fixedChildren.push(this)});if(0<a.fixedChildren.length){var e={position:"relative"};e[a.options.direction]="1px";a.setPanelStyle(e);0==parseInt(c(a.fixedChildren[0]).offset().left)&&(a.settings.shiftFixedChildren=!0)}a.setPanelStyle(b)},setjPanelMenuStyles:function(){var b="#fff",b=c("html").css("background-color"),e=c("body").css("background-color"),b="transparent"!=e&&"rgba(0, 0, 0, 0)"!=e?e:"transparent"!=b&&"rgba(0, 0, 0, 0)"!=b?b:"#fff";0==c("#jPanelMenu-style-master").length&&
c("body").append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+a.options.direction+":0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;"+a.computePositionStyle(!1,!0)+"z-index:2;width:100%;min-height:100%;background:"+b+"}</style>")},setMenuState:function(a){c("body").attr("data-menu-position",a?"open":"closed")},getMenuState:function(){return c("body").attr("data-menu-position")},
menuIsOpen:function(){return"open"==a.getMenuState()?!0:!1},setMenuStyle:function(b){c(a.menu).css(b)},setPanelStyle:function(b){c(a.panel).css(b)},showMenu:function(){a.setMenuStyle({display:"block"});a.setMenuStyle({"z-index":"1"});!a.options.alwaysShowFirstMenu&&c(".jPanel__slidesPanels").css({marginLeft:0})},hideMenu:function(){a.setMenuStyle({"z-index":"-1"});a.setMenuStyle({display:"none"})},enableTransitions:function(b,e){var d=b/1E3,f=a.getCSSEasingFunction(e);a.disableTransitions();c("body").append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{'+
a.settings.cssPrefix+"transition: all "+d+"s "+f+"; transition: all "+d+"s "+f+";}</style>")},disableTransitions:function(){c("#jPanelMenu-style-transitions").remove()},enableFixedTransitions:function(b,e,d,f){d/=1E3;f=a.getCSSEasingFunction(f);a.disableFixedTransitions(e);c("body").append('<style id="jPanelMenu-style-fixed-'+e+'">'+b+"{"+a.settings.cssPrefix+"transition: all "+d+"s "+f+"; transition: all "+d+"s "+f+";}</style>")},disableFixedTransitions:function(a){c("#jPanelMenu-style-fixed-"+a).remove()},
getCSSEasingFunction:function(a){switch(a){case "linear":return a;case "ease":return a;case "ease-in":return a;case "ease-out":return a;case "ease-in-out":return a;default:return"ease-in-out"}},getJSEasingFunction:function(a){switch(a){case "linear":return a;default:return"swing"}},getVendorPrefix:function(){if("result"in arguments.callee)return arguments.callee.result;var a=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,c=document.getElementsByTagName("script")[0],d;for(d in c.style)if(a.test(d))return arguments.callee.result=
d.match(a)[0];return"WebkitOpacity"in c.style?arguments.callee.result="Webkit":"KhtmlOpacity"in c.style?arguments.callee.result="Khtml":arguments.callee.result=""},getCSSPrefix:function(){var c=a.getVendorPrefix();return""!=c?"-"+c.toLowerCase()+"-":""},openMenu:function(b){if("undefined"==typeof b||null==b)b=a.options.animated;a.clearTimeouts();a.options.before();a.options.beforeOpen();a.setMenuState(!0);a.setPanelStyle({position:"relative"});a.showMenu();var e=!b?!0:!1,d=b&&a.settings.transitionsSupported?
!0:!1;if(d||e)e&&a.disableTransitions(),d&&a.enableTransitions(a.options.openDuration,a.options.openEasing),b=a.computePositionStyle(!0),a.setPanelStyle(b),a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+" "+c(this).attr("class"),f=b.replace(" ","."),b=b.replace(" ","-");e&&a.disableFixedTransitions(b);d&&a.enableFixedTransitions(f,b,a.options.openDuration,a.options.openEasing);b={};b[a.options.direction]=a.options.openPosition;c(this).css(b)}),
a.timeouts.afterOpen=setTimeout(function(){a.disableTransitions();a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+" "+c(this).attr("class"),b=b.replace(" ","-");a.disableFixedTransitions(b)});a.options.after();a.options.afterOpen();a.initiateContentClickListeners()},a.options.openDuration);else{var f=a.getJSEasingFunction(a.options.openEasing);b={};b[a.options.direction]=a.options.openPosition;c(a.panel).stop().animate(b,a.options.openDuration,
f,function(){a.options.after();a.options.afterOpen();a.initiateContentClickListeners()});a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b={};b[a.options.direction]=a.options.openPosition;c(this).stop().animate(b,a.options.openDuration,f)})}},closeMenu:function(b){if("undefined"==typeof b||null==b)b=a.options.animated;a.clearTimeouts();a.options.before();a.options.beforeClose();a.setMenuState(!1);var e=!b?!0:!1,d=b&&a.settings.transitionsSupported?!0:!1;if(d||e)e&&a.disableTransitions(),
d&&a.enableTransitions(a.options.closeDuration,a.options.closeEasing),b=a.computePositionStyle(),a.setPanelStyle(b),a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+" "+c(this).attr("class"),f=b.replace(" ","."),b=b.replace(" ","-");e&&a.disableFixedTransitions(b);d&&a.enableFixedTransitions(f,b,a.options.closeDuration,a.options.closeEasing);b={};b[a.options.direction]=0+a.settings.positionUnits;c(this).css(b)}),a.timeouts.afterClose=setTimeout(function(){a.setPanelStyle({position:a.settings.panelPosition});
a.disableTransitions();a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+" "+c(this).attr("class"),b=b.replace(" ","-");a.disableFixedTransitions(b)});a.hideMenu();a.options.after();a.options.afterClose();a.destroyContentClickListeners()},a.options.closeDuration);else{var f=a.getJSEasingFunction(a.options.closeEasing);b={};b[a.options.direction]=0+a.settings.positionUnits;c(a.panel).stop().animate(b,a.options.closeDuration,f,function(){a.setPanelStyle({position:a.settings.panelPosition});
a.hideMenu();a.options.after();a.options.afterClose();a.destroyContentClickListeners()});a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b={};b[a.options.direction]=0+a.settings.positionUnits;c(this).stop().animate(b,a.options.closeDuration,f)})}},triggerMenu:function(b){a.menuIsOpen()?a.closeMenu(b):a.openMenu(b)},initiateClickListeners:function(){c(document).on("click",a.options.trigger,function(){a.triggerMenu(a.options.animated);return!1})},destroyClickListeners:function(){c(document).off("click",
a.options.trigger,null)},initiateContentClickListeners:function(){if(!a.options.closeOnContentClick)return!1;c(document).on("click",a.panel,function(){a.menuIsOpen()&&a.closeMenu(a.options.animated)});c(document).on("touchend",a.panel,function(){a.menuIsOpen()&&a.closeMenu(a.options.animated)})},destroyContentClickListeners:function(){if(!a.options.closeOnContentClick)return!1;c(document).off("click",a.panel,null);c(document).off("touchend",a.panel,null)},initiateKeyboardListeners:function(){var b=
["input","textarea"];c(document).on("keydown",function(e){var d=c(e.target),f=!1;c.each(b,function(){d.is(this.toString())&&(f=!0)});if(f)return!0;for(mapping in a.options.keyboardShortcuts)if(e.which==a.options.keyboardShortcuts[mapping].code)return e=a.options.keyboardShortcuts[mapping],e.open&&e.close?a.triggerMenu(a.options.animated):e.open&&!e.close&&!a.menuIsOpen()?a.openMenu(a.options.animated):!e.open&&e.close&&a.menuIsOpen()&&a.closeMenu(a.options.animated),!1})},destroyKeyboardListeners:function(){c(document).off("keydown",
null)},setupMarkup:function(){c("html").addClass("jPanelMenu");c("body > *").not(a.menu+", "+a.options.excludedPanelContent).wrapAll('<div class="'+a.panel.replace(".","")+'"/>');var b=c(a.options.menu).clone(),e={},d=0,f=0;b.find("ul").each(function(a,b){var g=c(b),h=g.parent("li");"undefined"==typeof g.attr("id")&&g.attr("id","jPanel-ul-"+d);"undefined"==typeof h.attr("id")&&h.attr("id","jPanel-li-"+d++);if("undefined"!=typeof c(h).get(0)&&"LI"==c(h).get(0).tagName){var j=g.parents("li").length,
k="jPanel__"+j;j>f&&(f=j);h.addClass("jPanel_has_subnav").attr("data-jPanel-target",g.attr("id"));"undefined"==typeof e[k]&&(e[k]=[]);e[k].push(g)}});var g=10+f;b.attr("id",a.menu.replace("#","")).insertAfter("body > "+a.panel).children().wrapAll('<div class="jPanel__slide_menu" id="jPanel__0" style="z-index:'+g--+'" />');c.map(e,function(b,d){c('<div class="jPanel__slide_menu" id="'+d+'" />').appendTo(c(a.menu)).prepend('<ul class="jPanel_controls"><li data-action="prev"><a href="javascript:void(0);"><< Back</a></li></ul>').append(b).css({zIndex:g--})});
c(".jPanel__slide_menu").wrapAll('<div class="jPanel__slidesPanels" />');b=c(".jPanel__slide_menu").length;c(".jPanel__slidesPanels").css({width:100*b+"%"});c(".jPanel__slide_menu").css({width:a.options.openPosition,"float":"left"})},resetMarkup:function(){c("html").removeClass("jPanelMenu");c("body > "+a.panel+" > *").unwrap();c(a.menu).remove()},movePanels:function(b){b=void 0==typeof b?1:"back"==b?1:-1;var e=c(".jPanel__slidesPanels"),d=parseInt(e.css("margin-left"),10);console.log(d+b*parseInt(a.options.openPosition,
10));c(e).animate({marginLeft:d+b*parseInt(a.options.openPosition,10)})},setTriggers:function(){c(a.menu).find(".jPanel_controls li").click(function(){switch(c(this).data("action")){case "prev":a.movePanels("back")}});c(a.menu).find("li[data-jPanel-target]").click(function(){event.preventDefault();var b=c(this).parents(".jPanel__slide_menu");console.log(c(this).attr("data-jPanel-target"));nextULs=c(b).next().find("ul").not(".jPanel_controls");1<nextULs.length?nextULs.hide().siblings("#"+c(this).attr("data-jPanel-target")).show():
nextULs.show();a.movePanels();return!1})},init:function(){if(c("html").hasClass("jPanelMenu"))return a;a.options.beforeOn();a.setPositionUnits();a.setCSSPrefix();a.initiateClickListeners();"[object Array]"===Object.prototype.toString.call(a.options.keyboardShortcuts)&&a.initiateKeyboardListeners();a.setjPanelMenuStyles();a.setMenuState(!1);a.setupMarkup();a.setMenuStyle({width:a.options.openPosition});a.setTriggers();a.settings.transformsSupported||a.checkFixedChildren();a.closeMenu(!1);a.options.afterOn()},
destroy:function(){a.options.beforeOff();a.closeMenu();a.destroyClickListeners();"[object Array]"===Object.prototype.toString.call(a.options.keyboardShortcuts)&&a.destroyKeyboardListeners();a.resetMarkup();var b={};b[a.options.direction]="auto";c(a.fixedChildren).each(function(){c(this).css(b)});a.fixedChildren=[];a.options.afterOff()}};return{on:a.init,off:a.destroy,trigger:a.triggerMenu,open:a.openMenu,close:a.closeMenu,isOpen:a.menuIsOpen,menu:a.menu,getMenu:function(){return c(a.menu)},panel:a.panel,
getPanel:function(){return c(a.panel)}}}})(jQuery);